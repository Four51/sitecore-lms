<div *ngIf="orderSummaryMeta">
  <div
    *ngFor="let method of _acceptedPaymentMethods; let i = index"
    class="form-check"
  >
    <input
      (change)="selectPaymentMethod($event)"
      class="form-check-input"
      type="radio"
      name="{{ i }}"
      id="{{ i }}"
      value="{{ method }}"
      [checked]="selectedPaymentMethod === method"
    />
    <label class="form-check-label" for="{{ i }}">
      {{ getPaymentMethodName(method) }}
    </label>
  </div>
  <ocm-stripe-payment
    *ngIf="
      orderSummaryMeta.LineItemCount && selectedPaymentMethod === 'CreditCard'
    "
    (cardSelected)="onStripeCardSuccess($event)"
  ></ocm-stripe-payment>
  <ng-container
    *ngIf="
      orderSummaryMeta.LineItemCount &&
      selectedPaymentMethod === 'PurchaseOrder'
    "
  >
    <small class="d-block font-italic text-muted">
      The price reflected on this order includes an estimate for sales tax and
      shipping costs. Actual final cost may vary slightly as a result. By
      submitting this order, you accept these terms.
      <a
        href="https://learning.sitecore.com/frequently-asked-questions#purchase_order"
        target="_blank"
        >Terms</a
      >
    </small>
    <div class="mt-3">
      <button
        [disabled]="POTermsAccepted"
        type="submit"
        (click)="acceptPOTerms()"
        class="btn btn-info btn-block-xs mr-2"
      >
        Accept
      </button>
      <fa-icon
        *ngIf="POTermsAccepted"
        [icon]="faCheckCircle"
        class="text-success"
      ></fa-icon>
    </div>
    <div class="mt-3 form-group" *ngIf="!isAnon">
      <label for="selectAddress">Billing Address</label>
      <select
        [ngModel]="selectedBillingAddress?.ID"
        (ngModelChange)="onBillingAddressChange($event)"
        class="custom-select"
        id="selectAddress"
      >
        <option [ngValue]="null" default disabled translate>
          CHECKOUT.CHECKOUT_ADDRESS.SELECT_ADDRESS
        </option>
        <option
          *ngFor="let address of existingBillingAddresses?.Items"
          [ngValue]="address.ID"
        >
          <span class="font-weight-bold"
            >{{ address.Street1
            }}<span *ngIf="address.Street2"> {{ address.Street2 }}</span
            >, {{ address.City }} {{ address.State }} {{ address.Zip }}
          </span>
        </option>
      </select>
      <button
        (click)="showNewAddress()"
        class="btn btn-outline-primary btn-sm mr-2 mt-3"
        translate
      >
        Add New Address
      </button>
    </div>
    <ocm-address-form
      *ngIf="showNewAddressForm && homeCountry"
      [existingAddress]="selectedBillingAddress"
      [suggestedAddresses]="suggestedAddresses"
      [showOptionToSave]="true"
      [homeCountry]="homeCountry"
      [btnText]="'Save and Continue'"
      [addressError]="_addressError"
      (formDismissed)="handleFormDismissed()"
      (formChanged)="addressFormChanged($event.detail)"
      (formSubmitted)="saveAddressesAndContinue($event.detail.address)"
    >
    </ocm-address-form>
  </ng-container>
  <button
    type="submit"
    (click)="onContinue()"
    *ngIf="selectedPaymentMethod === 'PurchaseOrder'"
    class="btn btn-primary btn-block-xs mt-4 mr-2"
    [disabled]="orderSummaryMeta.LineItemCount && !POTermsAccepted"
  >
    Submit Order
  </button>
</div>
